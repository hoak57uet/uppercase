{{ define "main" }}
<div class="container">
    <h1>CSV to JSON and JSON to CSV Converter - Fast File Upload Tool</h1>
    <p>Easily convert CSV to JSON or JSON to CSV with our online converter. Upload CSV files or input JSON data, and get
        your conversion done in seconds. Perfect for developers and data professionals.</p>
    <div class="upload-box" id="uploadBox">
        <input type="file" id="fileInput" accept="text/csv"/>
        <p>Drag & drop an CSV file here or <span>browse</span></p>
    </div>
    <div class="textarea-container">
        <!-- Input text area -->
        <div class="output-box">
            <label for="outputText">Enter your text</label>
            <textarea id="inputText" placeholder="Enter your text here..."></textarea>
            <div class="counts">
                Character Count: <span id="charCount">0</span> |
                Word Count: <span id="wordCount">0</span> |
                Sentence Count: <span id="sentenceCount">0</span> |
                Line Count: <span id="lineCount">0</span>
            </div>
        </div>
        <!-- Output text area -->
        <div class="output-box">
            <label for="outputText">JSON Text</label>
            <textarea id="outputText" placeholder="JSON text will appear here..."></textarea>
            <div>
                <button class="copy-button" id="copy-output" onclick="copyText('outputText', 'copy-output')">
                    Copy
                </button>
                <span class="copied-message" id="copiedMessage1">Copied</span>
            </div>
        </div>
    </div>

    <div>
        <section>
            <h2>About Our CSV to JSON and JSON to CSV Converter Tool</h2>
            <p>Our CSV to JSON and JSON to CSV converter tool allows you to quickly convert between these two popular
                data formats. Whether you're a developer, data scientist, or just someone dealing with CSV or JSON
                files, this tool will simplify your workflow. You can upload CSV files or paste JSON data directly into
                the tool for instant conversion. No more hassle of writing code just to handle format conversions!</p>

            <p>CSV (Comma-Separated Values) and JSON (JavaScript Object Notation) are both widely used formats for
                storing and exchanging data. CSV files are commonly used for spreadsheets and tabular data, while JSON
                is popular in web development and API communication. Our tool bridges the gap between these two formats,
                making data transformation simple and quick.</p>

            <h2>How It Works</h2>
            <p>Using our CSV to JSON and JSON to CSV converter is simple and straightforward:</p>

            <ul>
                <li><strong>Convert CSV to JSON:</strong> Upload your CSV file or paste CSV content into the input box,
                    then click the "Convert to JSON" button. The tool will automatically convert the CSV data into JSON
                    format.
                </li>
                <li><strong>Convert JSON to CSV:</strong> Input your JSON data directly or upload a .json file, then
                    click the "Convert to CSV" button. The tool will instantly transform your JSON data into CSV format.
                </li>
                <li><strong>Download the converted file:</strong> After the conversion, you can download the result in
                    the desired format to your device for further use.
                </li>
            </ul>

            <p>Our tool handles large datasets efficiently, maintaining the integrity of your data throughout the
                conversion process. It supports various CSV and JSON formats, making it ideal for a range of use cases,
                including data analysis, web development, and database management.</p>
        </section>
        <section>
            <h2>Frequently Asked Questions (FAQ)</h2>

            <h3>1. What is CSV?</h3>
            <p>CSV stands for Comma-Separated Values. It's a lightweight, tabular data format where each row represents
                a data record, and columns are separated by commas. It is widely used for exporting and importing data,
                especially in spreadsheets and databases.</p>

            <h3>2. What is JSON?</h3>
            <p>JSON (JavaScript Object Notation) is a lightweight data-interchange format used mainly for transmitting
                data between a server and a web application. JSON is easy to read and write for humans and is
                machine-readable, making it popular for APIs.</p>

            <h3>3. How do I convert CSV to JSON?</h3>
            <p>Simply upload your CSV file or paste your CSV text into our tool. Click "Convert to JSON" and the tool
                will output the JSON equivalent of your CSV data. You can then download the JSON file or copy it
                directly.</p>

            <h3>4. How do I convert JSON to CSV?</h3>
            <p>To convert JSON to CSV, input your JSON data or upload a .json file. Click "Convert to CSV" and your data
                will be transformed into CSV format, ready for download or further processing.</p>

            <h3>5. Can I upload files for conversion?</h3>
            <p>Yes! You can easily upload CSV or JSON files directly from your device. Our tool will handle the
                conversion and give you a download link for the converted file.</p>

            <h3>6. What types of CSV and JSON formats are supported?</h3>
            <p>Our tool supports standard CSV files and JSON objects. It can handle a wide variety of data structures,
                including nested JSON objects and arrays. The converted files will maintain their data integrity and
                formatting.</p>

            <h3>7. Is there a limit to the file size I can upload?</h3>
            <p>Our tool is optimized for large files, but for best performance, we recommend using files under 50MB.
                Larger files may take a longer time to process, but the tool will still handle them efficiently.</p>

            <h3>8. Is my data secure when using this tool?</h3>
            <p>Yes, your data is secure. All file conversions happen directly in your browser, ensuring that your data
                is never uploaded to external servers. You can safely convert your sensitive files without worry.</p>

        </section>

    </div>


</div>

<script>
    // Copy text function
    function copyText(textAreaId, messageId) {
        const textArea = document.getElementById(textAreaId);
        const message = document.getElementById(messageId);

        textArea.select();
        document.execCommand('copy');

        message.style.opacity = 1;
        setTimeout(() => {
            message.style.opacity = 0;
        }, 1000);
    }

    function countWords(inputText) {

        // Character count
        document.getElementById('charCount').textContent = inputText.length;

        // Word count
        const wordCount = inputText.trim() === '' ? 0 : inputText.trim().split(/\s+/).length;
        document.getElementById('wordCount').textContent = wordCount;

        // Sentence count
        const sentenceCount = inputText.split(/[.!?]+/).filter(Boolean).length;
        document.getElementById('sentenceCount').textContent = sentenceCount;

        // Line count
        const lineCount = inputText.split(/\n/).length;
        document.getElementById('lineCount').textContent = lineCount;
    }

    function csvToJson(csv) {
        const lines = csv.split("\n");
        const result = [];
        const headers = lines[0].split(",");

        for (let i = 1; i < lines.length; i++) {
            const obj = {};
            const currentLine = lines[i].split(",");

            for (let j = 0; j < headers.length; j++) {
                obj[headers[j].trim()] = currentLine[j] ? currentLine[j].trim() : "";
            }

            if (Object.keys(obj).length > 0 && Object.values(obj).some(val => val !== "")) {
                result.push(obj);
            }
        }

        return JSON.stringify(result, null, 2);
    }

    function jsonToCsv(json) {
        const array = typeof json !== 'object' ? JSON.parse(json) : json;
        const headers = Object.keys(array[0]);
        const csv = [
            headers.join(","), // Dòng đầu là các tiêu đề
            ...array.map(row => headers.map(header => row[header] || "").join(","))
        ].join("\n");

        return csv;
    }

    uploadBox.addEventListener('click', () => {
        fileInput.click();
    });

    uploadBox.addEventListener('dragover', (e) => {
        e.preventDefault();
        uploadBox.style.borderColor = '#007bff';
        uploadBox.style.backgroundColor = '#f0f8ff';
    });

    uploadBox.addEventListener('dragleave', () => {
        uploadBox.style.borderColor = '#aaa';
        uploadBox.style.backgroundColor = '#f9f9f9';
    });

    uploadBox.addEventListener('drop', (e) => {
        e.preventDefault();
        handleFileUpload(e.dataTransfer.files[0]);
        uploadBox.style.borderColor = '#aaa';
        uploadBox.style.backgroundColor = '#f9f9f9';
    });

    fileInput.addEventListener('change', () => {
        handleFileUpload(fileInput.files[0]);
    });

    function handleFileUpload(file) {
        const reader = new FileReader();
        reader.onload = function (e) {
            const content = e.target.result;
            document.getElementById('inputText').textContent = content;
            document.getElementById('outputText').value = csvToJson(content);
        };
        reader.readAsText(file);

    }


    // Event listener to handle input changes and mode
    document.getElementById('inputText').addEventListener('input', function () {
        const inputText = this.value;
        document.getElementById('outputText').value = csvToJson(inputText);
    });

    document.getElementById('outputText').addEventListener('input', function () {
        const inputText = this.value;
        document.getElementById('inputText').value = jsonToCsv(inputText);
    });
</script>
{{ end }}